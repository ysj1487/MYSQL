CREATE TABLE PPC_MAST_201312
(
	SSN CHAR(13) NOT NULL,
	ACCT_NO CHAR(10) NOT NULL,
	ACCT_CD DECIMAL(10) NOT NULL,
	PRFT DECIMAL(15,0),
	BALANCE_AMT DECIMAL(15,0)
);

INSERT INTO PPC_MAST_201312 VALUES ('7802221111111', '22033', 130, 504, 56746);

INSERT INTO PPC_MAST_201312 VALUES ('8307153333444', '54412', 110, 585, 23540);

INSERT INTO PPC_MAST_201312 VALUES ('5605099999222', '65433', 340, 213, 987800);

INSERT INTO PPC_MAST_201312 VALUES ('8012301111333', '58721', 320, 780, 310000);

INSERT INTO PPC_MAST_201312 VALUES ('6711032222111', '23422', 120, 5679, 3);

INSERT INTO PPC_MAST_201312 VALUES ('8910103333222', '89811', 310, 240, 40011);

INSERT INTO PPC_MAST_201312 VALUES ('7802221111111', '78022', 100, 899, 4565000);

INSERT INTO PPC_MAST_201312 VALUES ('6711032222111', '35714', 300, 3780, 2545640);

INSERT INTO PPC_MAST_201312 VALUES ('8910103333222', '68740', 310, 233, 522312);

INSERT INTO PPC_MAST_201312 VALUES ('5605099999222', '96870', 330, 7000, 2158);

INSERT INTO PPC_MAST_201312 VALUES ('7802221111111', '89770', 140, 1000, 566600);

INSERT INTO PPC_MAST_201312 VALUES ('6711032222111', '33270', 130, 5600, 68770);

INSERT INTO PPC_MAST_201312 VALUES ('7802221111111', '87890', 340, 1270, 5500000);

/*고객계좌별 수익
SSN CHAR(13) - 주민번호
ACCT_NO - 계좌번호
ACCT_CD - 종별 코드 (수신 : 100, 110, 120, 130, 140/ 여신 - 300, 310, 320, 330, 340  )
PRFT - 수익
BALANCE_AMT - 잔액


1. 수신액은 1, 여신은 0으로 구분하고 각각 총액을 구하시오
2. 고객 당 금융상품 가입수를 구하시오
3. 고객당 잔액 합계가 200만원 이상인 고객을 구하시오
4. 고객당 금융상품 가입자수가 2개 이상인 고객을 구하시오
*/
select * from PPC_MAST_201312;

select sum(BALANCE_AMT(case when acct_cd = 100 then 1
when acct_cd =110 then 1
when acct_cd = 120 then 1
when acct_cd =130 then 1
when acct_cd = 140 then 1
when acct_cd = 300 then 0
when acct_cd = 310 then 0
when acct_cd = 320 then 0
when acct_cd = 330 then 0
when acct_cd = 340 then 0
end)) as new_sal from PPC_MAST_201312 group by ACCT_CD;


select case when ACCT_CD in (100,110,120,130,140) then 1
when ACCT_CD in (300,310,320,330,340) then 0 end as ac , sum(BALANCE_AMT) from PPC_MAST_201312 group by ac;

select ssn, count(ACCT_cd) from PPC_MAST_201312 group by ssn;

select ssn,sum(BALANCE_AMT) as total from PPC_MAST_201312 group by ssn having total >=2000000;

select ssn, count(*) as cb from PPC_MAST_201312 group by ssn having cb>=2;

CREATE TABLE RCPT_ACCT

(

	SSN CHAR(13) NOT NULL,

	ACCT_NO CHAR(10) PRIMARY KEY NOT NULL,

	NEW_DT DATE,

	CNCL_DT DATE,

	RCPT_AMT DECIMAL(15,0)

);



INSERT INTO RCPT_ACCT VALUES ('5707121111000', '578221', '2012-03-26', null, 500000);

INSERT INTO RCPT_ACCT VALUES ('7706302222111', '687322', '2011-12-22', '2013-12-01', 0);

INSERT INTO RCPT_ACCT VALUES ('6508112222333', '658720', '2013-06-08', null, 41324);

INSERT INTO RCPT_ACCT VALUES ('8204073333111', '554520', '2013-09-28', null, 5678740);

INSERT INTO RCPT_ACCT VALUES ('5707121111000', '656421', '2009-11-17', null, 354210);

INSERT INTO RCPT_ACCT VALUES ('7706302222111', '668721', '2010-07-27', null, 547700);

INSERT INTO RCPT_ACCT VALUES ('8204073333111', '223620', '2010-09-11', null, 1000357);

INSERT INTO RCPT_ACCT VALUES ('8204073333111', '275123', '2013-11-26', null, 123000);



CREATE TABLE CUST_PARTY

(

	SSN CHAR(13) PRIMARY KEY NOT NULL,

	PARTY_NM CHAR(10) NOT NULL,

	CUST_ID CHAR(10) NOT NULL,

	TEL_NO CHAR(20) NOT NULL,

	MOBILE_NO CHAR(20) NOT NULL

);



INSERT INTO CUST_PARTY VALUES ('5707121111000', 'AR KIM', '5670', '02-555-6678', '010-1111-1111');

INSERT INTO CUST_PARTY VALUES ('6912081111222', 'SH HONG', '2357', '031-4456-9887', '010-2222-2222');

INSERT INTO CUST_PARTY VALUES ('8311221111333', 'MK KANG', '3977', '051-999-8888', '010-3333-3333');

INSERT INTO CUST_PARTY VALUES ('7105252222000', 'JH KIM', '8988', '032-333-1111', '010-4444-4444');

INSERT INTO CUST_PARTY VALUES ('7706302222111', 'JH LEE', '7702', '033-111-3355', '010-5555-5555');

INSERT INTO CUST_PARTY VALUES ('6508112222333', 'JH RYU', '3574', '02-6666-4444', '010-6666-6666');

INSERT INTO CUST_PARTY VALUES ('8204073333111', 'YC JUNG', '5670', '02-2222-1111', '010-7777-7777');

INSERT INTO CUST_PARTY VALUES ('8911293333222', 'JH JUN', '6989', '031-224-2222', '010-8888-8888');

INSERT INTO CUST_PARTY VALUES ('9011034444111', 'SH LEE', '5570', '033-333-3333', '010-9999-9999');


/*


1. 현재 살아있는 고객의 휴대폰 번호를 찾고, 살아있는 계좌수를 기준으로 오름차순 정렬하시오

2. 현재 살아있는 계좌수가 두 개 이상이고 수신잔액의 총합이 50만원 이상인 고객의 주민번호, 이름, 휴대전화, 

   계좌수, 수신잔액 총합을 주민번호기준으로 오름차순 정렬하시오.
   
 */  
   
   

CREATE TABLE EMPLOYEE
(
	EMP_ID CHAR(5) PRIMARY KEY NOT NULL,
	GRADE CHAR(10) NOT NULL,
	NM CHAR(10),
	TEL_NO CHAR(20)
);

INSERT INTO EMPLOYEE VALUES ('15501', '8', 'YK MO', '5740');
INSERT INTO EMPLOYEE VALUES ('15687', '8', 'SS CHANG', '5547');
INSERT INTO EMPLOYEE VALUES ('16780', '5', 'HY YOO', '2327');
INSERT INTO EMPLOYEE VALUES ('63278', '7', 'JW PARK', '2304');
INSERT INTO EMPLOYEE VALUES ('87871', '7', 'SW HONG', '2367');
INSERT INTO EMPLOYEE VALUES ('23578', '6', 'JI CHOI', '4654');
INSERT INTO EMPLOYEE VALUES ('32480', '6', 'JM CHA', '1270');
INSERT INTO EMPLOYEE VALUES ('23480', '5', 'KE LEE', '5466');